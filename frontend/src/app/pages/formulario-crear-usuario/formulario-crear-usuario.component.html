<div *ngIf="mostrarFormulario">
  <!-- Overlay -->
  <div class="formulario-overlay" (click)="cerrarFormulario()">
    <!-- Formulario -->
    <div class="formulario-usuario" (click)="$event.stopPropagation()">
      <h5 class="mb-4">Ingrese al registro de usuario</h5>
      <form [formGroup]="usuarioForm" (ngSubmit)="guardarUsuario()">
        <p class="text-danger">{{ loginError }}</p>

        <div class="mb-3">
          <label for="firstname" class="form-label">Nombre:</label>
          <input 
            formControlName="firstname" 
            type="text" 
            id="firstname" 
            placeholder="Nombre"
            class="form-control"
            [ngClass]="{
              'is-invalid': firstname?.invalid && (firstname?.dirty || firstname?.touched),
              'is-valid': firstname?.valid && (firstname?.dirty || firstname?.touched)
            }"
          >
          <div *ngIf="firstname?.invalid && (firstname?.dirty || firstname?.touched)">
            <div *ngIf="firstname?.errors?.['required']" class="invalid-feedback">
              El nombre es requerido
            </div>
          </div>
        </div>

        <div class="mb-3">
          <label for="lastname" class="form-label">Apellido:</label>
          <input 
            formControlName="lastname" 
            type="text" 
            id="lastname" 
            placeholder="Apellido"
            class="form-control"
            [ngClass]="{
              'is-invalid': lastname?.invalid && (lastname?.dirty || lastname?.touched),
              'is-valid': lastname?.valid && (lastname?.dirty || lastname?.touched)
            }"
          >
          <div *ngIf="lastname?.invalid && (lastname?.dirty || lastname?.touched)">
            <div *ngIf="lastname?.errors?.['required']" class="invalid-feedback">
              El apellido es requerido
            </div>
          </div>
        </div>

        <div class="mb-3">
          <label for="username" class="form-label">Usuario:</label>
          <input 
            formControlName="username" 
            type="email" 
            id="username" 
            placeholder="name@example.com"
            class="form-control"
            [ngClass]="{
              'is-invalid': username?.invalid && (username?.dirty || username?.touched),
              'is-valid': username?.valid && (username?.dirty || username?.touched)
            }"
          >
          <div *ngIf="username?.invalid && (username?.dirty || username?.touched)">
            <div *ngIf="username?.errors?.['required']" class="invalid-feedback">
              El correo es requerido
            </div>
            <div *ngIf="username?.errors?.['email']" class="invalid-feedback">
              El correo debe tener un formato válido
            </div>
          </div>
        </div>

        <div class="mb-3">
          <label for="password" class="form-label">Contraseña:</label>
          <input 
            formControlName="password" 
            type="password" 
            id="password" 
            placeholder="Contraseña"
            class="form-control"
            [ngClass]="{
              'is-invalid': password?.invalid && (password?.dirty || password?.touched),
              'is-valid': password?.valid && (password?.dirty || password?.touched)
            }"
          >
          <div *ngIf="password?.invalid && (password?.dirty || password?.touched)">
            <div *ngIf="password?.errors?.['required']" class="invalid-feedback">
              La contraseña es requerida
            </div>
          </div>
        </div>

        <div class="mb-3">
          <label for="country" class="form-label">País:</label>
          <input 
            formControlName="country" 
            type="text" 
            id="country" 
            placeholder="País"
            class="form-control"
          >
        </div>

        <div class="mb-3">
          <label for="role" class="form-label">Rol:</label>
          <select 
            formControlName="role" 
            id="role"
            class="form-select"
          >
            <option value="ADMIN">Admin</option>
            <option value="USER">User</option>
          </select>
        </div>

        <div class="d-flex justify-content-end">
          <button type="submit" class="btn btn-success me-2">Guardar</button>
          <button type="button" class="btn btn-danger" (click)="cerrarFormulario()">Cancelar</button>
        </div>
      </form>
    </div>
  </div>
</div>
